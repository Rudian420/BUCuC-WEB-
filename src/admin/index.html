<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BUCuC Admin Panel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="../assets/css/variables.css" rel="stylesheet">
    <style>
        .admin-sidebar {
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            width: 250px;
            background: var(--dark-color);
            color: var(--light-color);
            padding: 20px 0;
            z-index: 1000;
        }
        
        .admin-main {
            margin-left: 250px;
            padding: 20px;
        }
        
        .admin-sidebar .nav-link {
            color: var(--light-color);
            padding: 12px 20px;
            border-radius: 0;
            margin: 2px 0;
        }
        
        .admin-sidebar .nav-link:hover,
        .admin-sidebar .nav-link.active {
            background: var(--primary-color);
            color: var(--light-color);
        }
        
        .stats-card {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }
        
        .stats-card .icon {
            font-size: 2.5rem;
            opacity: 0.8;
        }
        
        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow-md);
            margin-bottom: 20px;
        }
        
        .member-table img {
            width: 40px;
            height: 40px;
            object-fit: cover;
            border-radius: 50%;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .status-active {
            background: #d4edda;
            color: #155724;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        @media (max-width: 768px) {
            .admin-sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            
            .admin-sidebar.show {
                transform: translateX(0);
            }
            
            .admin-main {
                margin-left: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Admin Sidebar -->
    <nav class="admin-sidebar">
        <div class="px-3 mb-4">
            <h4 class="text-center">
                <i class="fas fa-crown text-warning me-2"></i>
                BUCuC Admin
            </h4>
        </div>
        
        <ul class="nav flex-column">
            <li class="nav-item">
                <a class="nav-link active" href="#dashboard" data-section="dashboard">
                    <i class="fas fa-tachometer-alt me-2"></i>
                    Dashboard
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#members" data-section="members">
                    <i class="fas fa-users me-2"></i>
                    Members
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#events" data-section="events">
                    <i class="fas fa-calendar me-2"></i>
                    Events
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#content" data-section="content">
                    <i class="fas fa-edit me-2"></i>
                    Content
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#analytics" data-section="analytics">
                    <i class="fas fa-chart-line me-2"></i>
                    Analytics
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#settings" data-section="settings">
                    <i class="fas fa-cog me-2"></i>
                    Settings
                </a>
            </li>
        </ul>
        
        <div class="mt-auto px-3">
            <hr class="text-light">
            <a href="../index.html" class="nav-link">
                <i class="fas fa-external-link-alt me-2"></i>
                View Website
            </a>
            <a href="#" class="nav-link" id="logout-btn">
                <i class="fas fa-sign-out-alt me-2"></i>
                Logout
            </a>
        </div>
    </nav>

    <!-- Mobile Toggle Button -->
    <button class="btn btn-primary d-md-none position-fixed" 
            style="top: 20px; left: 20px; z-index: 1100;" 
            id="sidebar-toggle">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Main Content -->
    <main class="admin-main">
        <!-- Dashboard Section -->
        <section id="dashboard-content" class="admin-section">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1>Dashboard</h1>
                <div class="text-muted">
                    <i class="fas fa-clock me-2"></i>
                    <span id="current-time"></span>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="row">
                <div class="col-lg-3 col-md-6">
                    <div class="stats-card">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h3 id="total-members">24</h3>
                                <p class="mb-0">Total Members</p>
                            </div>
                            <i class="fas fa-users icon"></i>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="stats-card">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h3 id="total-events">8</h3>
                                <p class="mb-0">Total Events</p>
                            </div>
                            <i class="fas fa-calendar icon"></i>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="stats-card">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h3 id="pending-registrations">12</h3>
                                <p class="mb-0">Pending Registrations</p>
                            </div>
                            <i class="fas fa-user-clock icon"></i>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="stats-card">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h3 id="site-visits">1,247</h3>
                                <p class="mb-0">Site Visits</p>
                            </div>
                            <i class="fas fa-eye icon"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="chart-container">
                <h4 class="mb-4">Recent Activity</h4>
                <div class="activity-list">
                    <div class="activity-item d-flex align-items-center py-3 border-bottom">
                        <i class="fas fa-user-plus text-success me-3"></i>
                        <div>
                            <strong>New member registration</strong>
                            <br>
                            <small class="text-muted">John Doe applied for Creative Department</small>
                        </div>
                        <small class="ms-auto text-muted">2 hours ago</small>
                    </div>
                    <div class="activity-item d-flex align-items-center py-3 border-bottom">
                        <i class="fas fa-calendar-plus text-primary me-3"></i>
                        <div>
                            <strong>New event created</strong>
                            <br>
                            <small class="text-muted">Cultural Festival 2025 scheduled</small>
                        </div>
                        <small class="ms-auto text-muted">5 hours ago</small>
                    </div>
                    <div class="activity-item d-flex align-items-center py-3">
                        <i class="fas fa-edit text-warning me-3"></i>
                        <div>
                            <strong>Content updated</strong>
                            <br>
                            <small class="text-muted">About section content modified</small>
                        </div>
                        <small class="ms-auto text-muted">1 day ago</small>
                    </div>
                </div>
            </div>
        </section>

        <!-- Members Section -->
        <section id="members-content" class="admin-section d-none">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1>Members Management</h1>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addMemberModal">
                    <i class="fas fa-plus me-2"></i>Add Member
                </button>
            </div>

            <div class="chart-container">
                <div class="table-responsive">
                    <table class="table member-table">
                        <thead>
                            <tr>
                                <th>Member</th>
                                <th>Position</th>
                                <th>Department</th>
                                <th>Join Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="members-table-body">
                            <!-- Members will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Events Section -->
        <section id="events-content" class="admin-section d-none">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1>Events Management</h1>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addEventModal">
                    <i class="fas fa-plus me-2"></i>Add Event
                </button>
            </div>

            <div class="row" id="events-grid">
                <!-- Events will be loaded here -->
            </div>
        </section>

        <!-- Content Section -->
        <section id="content-content" class="admin-section d-none">
            <h1 class="mb-4">Content Management</h1>
            
            <div class="chart-container">
                <h4>Website Content</h4>
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">About Section</label>
                            <textarea class="form-control" rows="5" id="about-content"></textarea>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Contact Information</label>
                            <textarea class="form-control" rows="5" id="contact-content"></textarea>
                        </div>
                    </div>
                </div>
                <button class="btn btn-success">
                    <i class="fas fa-save me-2"></i>Save Changes
                </button>
            </div>
        </section>

        <!-- Analytics Section -->
        <section id="analytics-content" class="admin-section d-none">
            <h1 class="mb-4">Analytics</h1>
            
            <div class="chart-container">
                <h4>Website Traffic</h4>
                <canvas id="trafficChart" width="400" height="200"></canvas>
            </div>
        </section>

        <!-- Settings Section -->
        <section id="settings-content" class="admin-section d-none">
            <h1 class="mb-4">Settings</h1>
            
            <div class="chart-container">
                <h4>General Settings</h4>
                <form>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Site Title</label>
                                <input type="text" class="form-control" value="BUCuC - BRAC University Cultural Club">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Contact Email</label>
                                <input type="email" class="form-control" value="hr.bucuc@gmail.com">
                            </div>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-save me-2"></i>Save Settings
                    </button>
                </form>
            </div>
        </section>
    </main>

    <!-- Add Member Modal -->
    <div class="modal fade" id="addMemberModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Member</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addMemberForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Full Name</label>
                                    <input type="text" class="form-control" name="name" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Position</label>
                                    <input type="text" class="form-control" name="position" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Department</label>
                                    <select class="form-select" name="department" required>
                                        <option value="">Select Department</option>
                                        <option value="Human Resource">Human Resource</option>
                                        <option value="Event Management & Logistics">Event Management & Logistics</option>
                                        <option value="Finance">Finance</option>
                                        <option value="Creative">Creative</option>
                                        <option value="Performance - Music">Performance - Music</option>
                                        <option value="Performance - Dance">Performance - Dance</option>
                                        <option value="Public Relations">Public Relations</option>
                                        <option value="Research & Development">Research & Development</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-control" name="email" required>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Bio</label>
                            <textarea class="form-control" name="bio" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary" form="addMemberForm">Add Member</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module">
        import { fetchData, showNotification } from '../utils/helpers.js';

        class AdminPanel {
            constructor() {
                this.currentSection = 'dashboard';
                this.init();
            }

            init() {
                this.setupNavigation();
                this.setupMobileToggle();
                this.updateTime();
                this.loadDashboardData();
                setInterval(() => this.updateTime(), 1000);
            }

            setupNavigation() {
                document.querySelectorAll('.nav-link[data-section]').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const section = link.getAttribute('data-section');
                        this.showSection(section);
                        
                        // Update active state
                        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                        link.classList.add('active');
                    });
                });
            }

            setupMobileToggle() {
                const toggleBtn = document.getElementById('sidebar-toggle');
                const sidebar = document.querySelector('.admin-sidebar');
                
                toggleBtn?.addEventListener('click', () => {
                    sidebar.classList.toggle('show');
                });
            }

            showSection(sectionName) {
                // Hide all sections
                document.querySelectorAll('.admin-section').forEach(section => {
                    section.classList.add('d-none');
                });
                
                // Show target section
                const targetSection = document.getElementById(`${sectionName}-content`);
                if (targetSection) {
                    targetSection.classList.remove('d-none');
                    this.currentSection = sectionName;
                    
                    // Load section-specific data
                    this.loadSectionData(sectionName);
                }
            }

            async loadSectionData(section) {
                switch (section) {
                    case 'members':
                        await this.loadMembers();
                        break;
                    case 'events':
                        await this.loadEvents();
                        break;
                    case 'content':
                        this.loadContent();
                        break;
                    case 'analytics':
                        this.loadAnalytics();
                        break;
                }
            }

            async loadMembers() {
                try {
                    const members = await fetchData('../data/sb-members.json');
                    const tbody = document.getElementById('members-table-body');
                    
                    if (members && tbody) {
                        tbody.innerHTML = members.map(member => `
                            <tr>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <img src="../${member.image}" alt="${member.name}" class="me-3">
                                        <div>
                                            <strong>${member.name}</strong>
                                            <br>
                                            <small class="text-muted">${member.email}</small>
                                        </div>
                                    </div>
                                </td>
                                <td>${member.position}</td>
                                <td>${member.department}</td>
                                <td>${member.joinYear}</td>
                                <td>
                                    <span class="status-badge status-active">Active</span>
                                </td>
                                <td>
                                    <button class="btn btn-sm btn-outline-primary me-2">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-danger">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        `).join('');
                    }
                } catch (error) {
                    console.error('Error loading members:', error);
                }
            }

            async loadEvents() {
                try {
                    const events = await fetchData('../data/events.json');
                    const grid = document.getElementById('events-grid');
                    
                    if (events && grid) {
                        grid.innerHTML = events.map(event => `
                            <div class="col-lg-4 col-md-6 mb-4">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">${event.title}</h5>
                                        <p class="card-text">${event.subtitle}</p>
                                        <p class="text-muted">
                                            <i class="fas fa-calendar me-2"></i>${event.date}
                                            <br>
                                            <i class="fas fa-clock me-2"></i>${event.time}
                                        </p>
                                        <span class="badge bg-${event.status === 'upcoming' ? 'success' : 'secondary'}">
                                            ${event.status}
                                        </span>
                                        <div class="mt-3">
                                            <button class="btn btn-sm btn-outline-primary me-2">
                                                <i class="fas fa-edit"></i> Edit
                                            </button>
                                            <button class="btn btn-sm btn-outline-danger">
                                                <i class="fas fa-trash"></i> Delete
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `).join('');
                    }
                } catch (error) {
                    console.error('Error loading events:', error);
                }
            }

            loadContent() {
                // Load existing content for editing
                console.log('Loading content management interface');
            }

            loadAnalytics() {
                // Load analytics charts
                console.log('Loading analytics data');
            }

            updateTime() {
                const now = new Date();
                const timeElement = document.getElementById('current-time');
                if (timeElement) {
                    timeElement.textContent = now.toLocaleString();
                }
            }

            async loadDashboardData() {
                try {
                    const [members, events] = await Promise.all([
                        fetchData('../data/sb-members.json'),
                        fetchData('../data/events.json')
                    ]);

                    if (members) {
                        document.getElementById('total-members').textContent = members.length;
                    }

                    if (events) {
                        document.getElementById('total-events').textContent = events.length;
                    }
                } catch (error) {
                    console.error('Error loading dashboard data:', error);
                }
            }
        }

        // Initialize admin panel
        new AdminPanel();
    </script>
</body>
</html>
